-- ============================================================================
-- Настройка плагина Origami для сворачивания кода
-- ============================================================================

require('origami').setup({
  -- автосворачивание и восстановление фолдов при переключении буферов
  setup_foldkeymaps = true,   -- включает стандартные клавиши 'za', 'zR', 'zM' и т.д.
  pause_fold_enable = false,  -- если true, можно временно отключить автофолды
})

-- ============================================================================
-- Общие настройки сворачивания кода
-- ============================================================================

vim.o.foldmethod = "expr"
vim.o.foldexpr = "nvim_treesitter#foldexpr()"  -- Используем Treesitter для анализа структуры кода
vim.o.foldlevel = 99
vim.o.foldlevelstart = 99
vim.o.foldenable = true

-- ============================================================================
-- Поведение при нажатии 'K' (просмотр документации)
-- ============================================================================

-- В Origami нет функции "peekFoldedLinesUnderCursor", как в UFO,
-- поэтому просто возвращаем стандартное поведение LSP hover:
vim.keymap.set('n', 'K', function()
  vim.lsp.buf.hover()
end)
